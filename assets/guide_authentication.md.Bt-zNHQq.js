import{_ as c,C as i,c as D,o as a,a2 as l,b as e,w as n,a as o,G as t,a3 as r}from"./chunks/framework.CulRYwFH.js";const E=JSON.parse('{"title":"Authentication","description":"","frontmatter":{},"headers":[],"relativePath":"guide/authentication.md","filePath":"guide/authentication.md"}'),F={name:"guide/authentication.md"};function y(u,s,b,m,A,d){const p=i("Mermaid");return a(),D("div",null,[s[2]||(s[2]=l(`<h1 id="authentication" tabindex="-1">Authentication <a class="header-anchor" href="#authentication" aria-label="Permalink to &quot;Authentication&quot;">‚Äã</a></h1><p>MCP Composer provides comprehensive authentication support for securing your MCP infrastructure and member servers.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">‚Äã</a></h2><p>Authentication in MCP Composer works at multiple levels:</p><ol><li><strong>Composer-level authentication</strong> - Secures the MCP Composer itself</li><li><strong>Server-level authentication</strong> - Handles authentication for each member server</li><li><strong>Tool-level authentication</strong> - Applies specific authentication for individual tools</li></ol><h2 id="üîê-authentication-methods" tabindex="-1">üîê Authentication Methods <a class="header-anchor" href="#üîê-authentication-methods" aria-label="Permalink to &quot;üîê Authentication Methods&quot;">‚Äã</a></h2><p>The <strong>Auth Handler</strong> supports the following authentication strategies:</p><h3 id="_1-bearer-token-authentication" tabindex="-1">1. Bearer Token Authentication <a class="header-anchor" href="#_1-bearer-token-authentication" aria-label="Permalink to &quot;1. Bearer Token Authentication&quot;">‚Äã</a></h3><p>The most common authentication method for API-based services.</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Server configuration with Bearer token</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_mcp_server</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">customer-api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">openapi</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">open_api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">endpoint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://api.customers.com/mcp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">spec_filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/openapi-spec.json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">bearer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">token</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">your_bearer_token_here</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>Features:</strong></p><ul><li>Automatic token inclusion in Authorization header</li><li>Support for token refresh</li><li>Secure token storage</li></ul><h3 id="_2-api-key-authentication" tabindex="-1">2. API Key Authentication <a class="header-anchor" href="#_2-api-key-authentication" aria-label="Permalink to &quot;2. API Key Authentication&quot;">‚Äã</a></h3><p>Simple key-based authentication for APIs.</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Server configuration with API key</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_mcp_server</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">product-api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">openapi</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">open_api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">endpoint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://api.products.com/mcp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">spec_filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/openapi-spec.json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">your_api_key_here</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">auth_prefix</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">X-API-Key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#676E95;font-style:italic;">  # Optional: custom header name</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>Features:</strong></p><ul><li>Customizable header names</li><li>Support for query parameter authentication</li><li>Simple key management</li></ul><h3 id="_3-oauth-2-0-authentication" tabindex="-1">3. OAuth 2.0 Authentication <a class="header-anchor" href="#_3-oauth-2-0-authentication" aria-label="Permalink to &quot;3. OAuth 2.0 Authentication&quot;">‚Äã</a></h3><p>Full OAuth 2.0 support for enterprise services.</p><p><strong>Recommended:</strong> Use environment variables in an <code>.env.oauth</code> file. See <code>.env.oauth.example</code> for the required variables. Example variables:</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span>OAUTH_HOST=localhost</span></span>
<span class="line"><span>OAUTH_PORT=8000</span></span>
<span class="line"><span>OAUTH_SERVER_URL=http://localhost:8000</span></span>
<span class="line"><span>OAUTH_CLIENT_ID=your_client_id</span></span>
<span class="line"><span>OAUTH_CLIENT_SECRET=your_client_secret</span></span>
<span class="line"><span>OAUTH_CALLBACK_PATH=/auth/callback</span></span>
<span class="line"><span>OAUTH_AUTH_URL=https://provider.com/oauth/authorize</span></span>
<span class="line"><span>OAUTH_TOKEN_URL=https://provider.com/oauth/token</span></span>
<span class="line"><span>OAUTH_MCP_SCOPE=user</span></span>
<span class="line"><span>OAUTH_PROVIDER_SCOPE=openid</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>Server configuration:</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_mcp_server</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">oauth-server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">http</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">endpoint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://api.oauth.com/mcp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">oauth2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">client_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">OAUTH_CLIENT_ID</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">client_secret</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">OAUTH_CLIENT_SECRET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">token_url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">OAUTH_TOKEN_URL</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p><strong>Note:</strong> The actual OAuth2 flow and callback handling is managed by the MCP Composer using the environment variables above. See the README and <code>.env.oauth.example</code> for more details.</p></blockquote><p><strong>Features:</strong></p><ul><li>Full OAuth 2.0 flow support</li><li>Automatic token refresh</li><li>Scope management</li><li>Authorization code flow</li></ul>`,26)),(a(),e(r,null,{default:n(()=>[t(p,{id:"mermaid-133",class:"mermaid-block",graph:"sequenceDiagram%0A%20%20%20%20participant%20Client%0A%20%20%20%20participant%20MCPComposer%0A%20%20%20%20participant%20OAuthProvider%0A%20%20%20%20participant%20MemberMCPServer%0A%0A%20%20%20%20Client-%3E%3EMCPComposer%3A%20call_tool%0A%20%20%20%20MCPComposer--%3E%3EOAuthProvider%3A%20request_access_token%0A%20%20%20%20OAuthProvider-%3E%3EOAuthProvider%3A%20validate%20token%0A%20%20%20%20OAuthProvider--%3E%3EMCPComposer%3A%20access_token%20%20%20%20%20%0A%20%20%20%20MCPComposer-%3E%3EMemberMCPServer%3A%20forward%20request%20with%20token%0A%20%20%20%20MemberMCPServer--%3E%3EMCPComposer%3A%20response%0A%20%20%20%20MCPComposer--%3E%3EClient%3A%20result%0A"})]),fallback:n(()=>s[0]||(s[0]=[o(" Loading... ",-1)])),_:1})),s[3]||(s[3]=l(`<p><strong>OAuth Authentication Flow Sequence Explanation:</strong></p><ol><li><p><strong>Client Request</strong> ‚Üí <strong>MCPComposer</strong></p><ul><li>Client initiates a tool call without needing to know OAuth details</li><li>MCPComposer receives the request and identifies the target server</li></ul></li><li><p><strong>MCPComposer</strong> ‚Üí <strong>OAuthProvider</strong> (Token Request)</p><ul><li>MCPComposer checks if a valid access token exists</li><li>If no token or expired, requests a new access token from OAuth provider</li><li>Uses stored client credentials (client_id, client_secret)</li></ul></li><li><p><strong>OAuthProvider</strong> ‚Üí <strong>OAuthProvider</strong> (Token Validation)</p><ul><li>OAuth provider validates the client credentials</li><li>Checks if the requested scopes are authorized</li><li>Generates or refreshes the access token</li></ul></li><li><p><strong>OAuthProvider</strong> ‚Üí <strong>MCPComposer</strong> (Token Response)</p><ul><li>Returns the access token to MCPComposer</li><li>Token is stored securely for future use</li><li>Includes token expiration information</li></ul></li><li><p><strong>MCPComposer</strong> ‚Üí <strong>MemberMCPServer</strong> (Authenticated Request)</p><ul><li>MCPComposer forwards the original client request</li><li>Includes the access token in the Authorization header</li><li>Request is now authenticated for the member server</li></ul></li><li><p><strong>MemberMCPServer</strong> ‚Üí <strong>MCPComposer</strong> (Response)</p><ul><li>Member server processes the authenticated request</li><li>Returns the result to MCPComposer</li><li>Response may include new token refresh information</li></ul></li><li><p><strong>MCPComposer</strong> ‚Üí <strong>Client</strong> (Final Result)</p><ul><li>MCPComposer forwards the result back to the client</li><li>Client receives the response without needing to handle OAuth complexity</li><li>Token management is completely transparent to the client</li></ul></li></ol><h3 id="_4-dynamic-bearer-ibm-iam-style" tabindex="-1">4. Dynamic Bearer (IBM IAM-style) <a class="header-anchor" href="#_4-dynamic-bearer-ibm-iam-style" aria-label="Permalink to &quot;4. Dynamic Bearer (IBM IAM-style)&quot;">‚Äã</a></h3><p>Dynamic token management for cloud services that require token exchange.</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_mcp_server</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">ibm-service</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">openapi</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">open_api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">endpoint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://api.service.ibm.com/instances/{instance-id}/v1/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">spec_filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/openapi-spec.json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">dynamic_bearer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">your_ibm_cloud_apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">token_url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://iam.cloud.ibm.com/identity/token</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">media_type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">json</span><span style="color:#89DDFF;">&quot;</span><span style="color:#676E95;font-style:italic;">  # Optional</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Here is a flow example</p>`,6)),(a(),e(r,null,{default:n(()=>[t(p,{id:"mermaid-298",class:"mermaid-block",graph:"sequenceDiagram%0A%20%20%20%20participant%20Client%0A%20%20%20%20participant%20MCPComposer%0A%20%20%20%20participant%20AuthAdapter%0A%20%20%20%20participant%20OAuthHandler%0A%20%20%20%20participant%20BearerTokenHandler%0A%20%20%20%20participant%20BasicAuthHandler%0A%20%20%20%20participant%20MCPServerA%0A%20%20%20%20participant%20MCPServerB%0A%20%20%20%20participant%20MCPServerC%0A%0A%20%20%20%20Client-%3E%3EMCPComposer%3A%20call_tool(%22server_id%22%2C%20payload)%0A%20%20%20%20MCPComposer-%3E%3EAuthAdapter%3A%20authenticate(server_id)%0A%0A%20%20%20%20alt%20server_id%20%3D%20MCPServerA%0A%20%20%20%20%20%20%20%20AuthAdapter-%3E%3EOAuthHandler%3A%20handleOAuth()%0A%20%20%20%20%20%20%20%20OAuthHandler-%3E%3EAuthAdapter%3A%20access_token%0A%20%20%20%20else%20server_id%20%3D%20MCPServerB%0A%20%20%20%20%20%20%20%20AuthAdapter-%3E%3EBearerTokenHandler%3A%20getDynamicToken()%0A%20%20%20%20%20%20%20%20BearerTokenHandler-%3E%3EAuthAdapter%3A%20bearer_token%0A%20%20%20%20else%20server_id%20%3D%20MCPServerC%0A%20%20%20%20%20%20%20%20AuthAdapter-%3E%3EBasicAuthHandler%3A%20getBasicAuthHeader()%0A%20%20%20%20%20%20%20%20BasicAuthHandler-%3E%3EAuthAdapter%3A%20basic_header%0A%20%20%20%20end%0A%0A%20%20%20%20AuthAdapter-%3E%3EMCPComposer%3A%20auth_headers%0A%0A%20%20%20%20alt%20OAuth%0A%20%20%20%20%20%20%20%20MCPComposer-%3E%3EMCPServerA%3A%20forward(payload%2C%20access_token)%0A%20%20%20%20else%20Bearer%0A%20%20%20%20%20%20%20%20MCPComposer-%3E%3EMCPServerB%3A%20forward(payload%2C%20bearer_token)%0A%20%20%20%20else%20Basic%0A%20%20%20%20%20%20%20%20MCPComposer-%3E%3EMCPServerC%3A%20forward(payload%2C%20basic_header)%0A%20%20%20%20end%0A%0A%20%20%20%20alt%20All%0A%20%20%20%20%20%20%20%20MCPServerA--%3E%3EMCPComposer%3A%20result%0A%20%20%20%20%20%20%20%20MCPServerB--%3E%3EMCPComposer%3A%20result%0A%20%20%20%20%20%20%20%20MCPServerC--%3E%3EMCPComposer%3A%20result%0A%20%20%20%20%20%20%20%20MCPComposer--%3E%3EClient%3A%20result%0A%20%20%20%20end%0A"})]),fallback:n(()=>s[1]||(s[1]=[o(" Loading... ",-1)])),_:1})),s[4]||(s[4]=l(`<p><strong>Token Exchange Flow Sequence Explanation:</strong></p><ol><li><p><strong>Client Request</strong> ‚Üí <strong>MCPComposer</strong></p><ul><li>Client calls a tool with server_id and payload</li><li>No authentication knowledge required from client</li><li>MCPComposer receives the request and identifies target server</li></ul></li><li><p><strong>MCPComposer</strong> ‚Üí <strong>AuthAdapter</strong> (Authentication Request)</p><ul><li>MCPComposer delegates authentication to AuthAdapter</li><li>Passes server_id for authentication strategy selection</li><li>AuthAdapter acts as the central authentication coordinator</li></ul></li><li><p><strong>AuthAdapter</strong> ‚Üí <strong>Strategy Handlers</strong> (Token Acquisition)</p><ul><li><strong>MCPServerA (OAuth)</strong>: Routes to OAuthHandler for OAuth2 flow</li><li><strong>MCPServerB (Dynamic Bearer)</strong>: Routes to BearerTokenHandler for dynamic token generation</li><li><strong>MCPServerC (Basic)</strong>: Routes to BasicAuthHandler for username/password</li></ul></li><li><p><strong>Strategy Handlers</strong> ‚Üí <strong>AuthAdapter</strong> (Token Response)</p><ul><li><strong>OAuthHandler</strong>: Returns access_token from OAuth2 flow</li><li><strong>BearerTokenHandler</strong>: Returns bearer_token from dynamic token exchange</li><li><strong>BasicAuthHandler</strong>: Returns basic_header with encoded credentials</li></ul></li><li><p><strong>AuthAdapter</strong> ‚Üí <strong>MCPComposer</strong> (Authentication Headers)</p><ul><li>AuthAdapter consolidates all authentication information</li><li>Returns appropriate auth_headers for the specific server</li><li>Handles any token formatting or header construction</li></ul></li><li><p><strong>MCPComposer</strong> ‚Üí <strong>Member Servers</strong> (Authenticated Forwarding)</p><ul><li><strong>MCPServerA</strong>: Request forwarded with OAuth access_token</li><li><strong>MCPServerB</strong>: Request forwarded with dynamic bearer_token</li><li><strong>MCPServerC</strong>: Request forwarded with basic authentication header</li></ul></li><li><p><strong>Member Servers</strong> ‚Üí <strong>MCPComposer</strong> (Response Collection)</p><ul><li>All member servers process authenticated requests</li><li>Return results to MCPComposer</li><li>Results may include new token information or refresh hints</li></ul></li><li><p><strong>MCPComposer</strong> ‚Üí <strong>Client</strong> (Final Result)</p><ul><li>MCPComposer consolidates all server responses</li><li>Returns unified result to client</li><li>Client receives response without authentication complexity</li></ul></li></ol><p><strong>Key Benefits of This Flow:</strong></p><ul><li><strong>Transparency</strong>: Client doesn&#39;t need to know authentication details</li><li><strong>Flexibility</strong>: Supports multiple authentication strategies simultaneously</li><li><strong>Centralization</strong>: All authentication logic centralized in AuthAdapter</li><li><strong>Scalability</strong>: Easy to add new authentication strategies</li><li><strong>Security</strong>: Authentication credentials never exposed to client</li></ul><h2 id="üèóÔ∏è-authentication-builder-implementation" tabindex="-1">üèóÔ∏è Authentication Builder Implementation <a class="header-anchor" href="#üèóÔ∏è-authentication-builder-implementation" aria-label="Permalink to &quot;üèóÔ∏è Authentication Builder Implementation&quot;">‚Äã</a></h2><p>The authentication system is implemented using the <strong>Adapter Design Pattern</strong> in the <code>MCPServerBuilder</code> class. This pattern provides a unified interface for different authentication strategies while encapsulating their specific implementations.</p><h3 id="core-builder-architecture" tabindex="-1">Core Builder Architecture <a class="header-anchor" href="#core-builder-architecture" aria-label="Permalink to &quot;Core Builder Architecture&quot;">‚Äã</a></h3><p>The <code>MCPServerBuilder</code> class handles authentication during server construction:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#C792EA;">class</span><span style="color:#FFCB6B;"> MCPServerBuilder</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">Builds a FastMCP server from a config block.</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#C792EA;">    async</span><span style="color:#C792EA;"> def</span><span style="color:#82AAFF;"> _build_from_openapi</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> -&gt;</span><span style="color:#BABED8;"> FastMCP</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        # ... spec loading logic ...</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#BABED8;">        auth_strategy </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">config</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">AUTH_STRATEGY</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">        auth_config </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">AUTH</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> {})</span></span>
<span class="line"><span style="color:#BABED8;">        base_url </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> openapi_config</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">ENDPOINT</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        # Authentication strategy routing</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        match</span><span style="color:#BABED8;"> auth_strategy</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">BASIC</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                # Basic authentication setup</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">DYNAMIC_BEARER</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                # Dynamic token client setup</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">BEARER</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                # Bearer token setup</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">APITOKEN</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                # API token setup</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">APIKEY</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                # API key setup</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">JSESSIONID</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                # Session-based authentication</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            case</span><span style="color:#BABED8;"> _</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">                # Default client</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="authentication-strategy-adapters" tabindex="-1">Authentication Strategy Adapters <a class="header-anchor" href="#authentication-strategy-adapters" aria-label="Permalink to &quot;Authentication Strategy Adapters&quot;">‚Äã</a></h3><p>Each authentication strategy has its own adapter implementation:</p><h4 id="_1-basic-authentication-adapter" tabindex="-1">1. Basic Authentication Adapter <a class="header-anchor" href="#_1-basic-authentication-adapter" aria-label="Permalink to &quot;1. Basic Authentication Adapter&quot;">‚Äã</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">BASIC</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    logger</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Setting up client for basic auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    username </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">USERNAME</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    password </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">PASSWORD</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    http_client </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> httpx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AsyncClient</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">        base_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">base_url</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">        auth</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">httpx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">BasicAuth</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">username</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> password</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">        headers</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">headers</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    )</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_2-dynamic-bearer-token-adapter" tabindex="-1">2. Dynamic Bearer Token Adapter <a class="header-anchor" href="#_2-dynamic-bearer-token-adapter" aria-label="Permalink to &quot;2. Dynamic Bearer Token Adapter&quot;">‚Äã</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">DYNAMIC_BEARER</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    http_client </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> DynamicTokenClient</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">        base_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">base_url</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">        token_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">Token_URL</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">        api_key</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">APIKEY</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">        media_type</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">MEDIA_TYPE</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">    )</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_3-bearer-token-adapter" tabindex="-1">3. Bearer Token Adapter <a class="header-anchor" href="#_3-bearer-token-adapter" aria-label="Permalink to &quot;3. Bearer Token Adapter&quot;">‚Äã</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">BEARER</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    logger</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Setting up header and client for bearer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    headers</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">AUTH_HEADER</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;"> =</span><span style="color:#89DDFF;"> (</span></span>
<span class="line"><span style="color:#C792EA;">        f</span><span style="color:#C3E88D;">&quot;Bearer </span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">TOKEN</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    )</span></span>
<span class="line"><span style="color:#BABED8;">    http_client </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> httpx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AsyncClient</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">base_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">base_url</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> headers</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">headers</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_4-api-token-adapter" tabindex="-1">4. API Token Adapter <a class="header-anchor" href="#_4-api-token-adapter" aria-label="Permalink to &quot;4. API Token Adapter&quot;">‚Äã</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">APITOKEN</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    logger</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Setting up header and client for apiToken</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    headers</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">AUTH_HEADER</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;"> =</span><span style="color:#89DDFF;"> (</span></span>
<span class="line"><span style="color:#C792EA;">        f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">AUTH_PREFIX</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#BABED8;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">TOKEN</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    )</span></span>
<span class="line"><span style="color:#BABED8;">    http_client </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> httpx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AsyncClient</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">base_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">base_url</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> headers</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">headers</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_5-api-key-adapter" tabindex="-1">5. API Key Adapter <a class="header-anchor" href="#_5-api-key-adapter" aria-label="Permalink to &quot;5. API Key Adapter&quot;">‚Äã</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">APIKEY</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    logger</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Setting up header and client for apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    headers</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">AUTH_HEADER</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;"> =</span><span style="color:#89DDFF;"> (</span></span>
<span class="line"><span style="color:#C792EA;">        f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">AUTH_PREFIX</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#BABED8;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">APIKEY</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    )</span></span>
<span class="line"><span style="color:#BABED8;">    http_client </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> httpx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AsyncClient</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">base_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">base_url</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> headers</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">headers</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_6-jsessionid-adapter" tabindex="-1">6. JSESSIONID Adapter <a class="header-anchor" href="#_6-jsessionid-adapter" aria-label="Permalink to &quot;6. JSESSIONID Adapter&quot;">‚Äã</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#BABED8;"> AuthStrategy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">JSESSIONID</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    logger</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Setting up header and client for jessionid</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    try</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        token_manager </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> DynamicTokenManager</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">            base_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">base_url</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">            auth_strategy</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">config</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">AUTH_STRATEGY</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">            login_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">LOGIN_URL</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">            username</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">USERNAME</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">            password</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">auth_config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">PASSWORD</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">        )</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#BABED8;">        http_client </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;font-style:italic;"> await</span><span style="color:#BABED8;"> token_manager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get_authenticated_http_client_for_jessonid</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    except</span><span style="color:#FFCB6B;"> Exception</span><span style="color:#89DDFF;font-style:italic;"> as</span><span style="color:#BABED8;"> e</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        logger</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Authentication error: </span><span style="color:#F78C6C;">%s</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> e</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="transport-level-authentication" tabindex="-1">Transport-Level Authentication <a class="header-anchor" href="#transport-level-authentication" aria-label="Permalink to &quot;Transport-Level Authentication&quot;">‚Äã</a></h3><p>For HTTP/SSE/STDIO transport types, authentication is handled at the transport level:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#C792EA;">async</span><span style="color:#C792EA;"> def</span><span style="color:#82AAFF;"> _build_from_transport</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> transport_type</span><span style="color:#89DDFF;">=None)</span><span style="color:#89DDFF;"> -&gt;</span><span style="color:#BABED8;"> FastMCP</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # ... transport class selection ...</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#BABED8;"> transport_type </span><span style="color:#89DDFF;">in</span><span style="color:#89DDFF;"> {</span><span style="color:#BABED8;">MemberServerType</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">HTTP</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> MemberServerType</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">SSE</span><span style="color:#89DDFF;">}:</span></span>
<span class="line"><span style="color:#BABED8;">        endpoint </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> config</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">ConfigKey</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">ENDPOINT</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">        auth </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> None</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        if</span><span style="color:#BABED8;"> oauth</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            FileTokenStorage</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">clear_all</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            auth </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> OAuth</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">mcp_url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">endpoint</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        transport </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> TransportClass</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">url</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">endpoint</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> headers</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">headers</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> auth</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">auth</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        client </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> Client</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">transport</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> auth</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">auth</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#BABED8;"> FastMCP</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">as_proxy</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">client</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> name</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">mcp_id</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="üîÑ-complete-authentication-flow" tabindex="-1">üîÑ Complete Authentication Flow <a class="header-anchor" href="#üîÑ-complete-authentication-flow" aria-label="Permalink to &quot;üîÑ Complete Authentication Flow&quot;">‚Äã</a></h2><p>The authentication flow integrates with the server building and tool execution pipeline:</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span>1. Client Request</span></span>
<span class="line"><span>   ‚îî‚îÄ‚îÄ call_tool(&quot;server_id&quot;, payload)</span></span>
<span class="line"><span>       ‚îÇ</span></span>
<span class="line"><span>       ‚ñº</span></span>
<span class="line"><span>2. Tool Manager</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Lookup tool in registry</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Route to appropriate server</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Apply tool filters</span></span>
<span class="line"><span>   ‚îî‚îÄ‚îÄ Check tool permissions</span></span>
<span class="line"><span>       ‚îÇ</span></span>
<span class="line"><span>       ‚ñº</span></span>
<span class="line"><span>3. Server Manager</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Find target server</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Check server health</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Apply load balancing</span></span>
<span class="line"><span>   ‚îî‚îÄ‚îÄ Handle failover</span></span>
<span class="line"><span>       ‚îÇ</span></span>
<span class="line"><span>       ‚ñº</span></span>
<span class="line"><span>4. Server Builder (Authentication)</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Parse auth_strategy from config</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Route to appropriate auth adapter</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Create authenticated HTTP client</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Handle token refresh/rotation</span></span>
<span class="line"><span>   ‚îî‚îÄ‚îÄ Build server with auth context</span></span>
<span class="line"><span>       ‚îÇ</span></span>
<span class="line"><span>       ‚ñº</span></span>
<span class="line"><span>5. Auth Adapter (Strategy Pattern)</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Basic Auth: httpx.BasicAuth</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Bearer Token: Authorization header</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Dynamic Bearer: DynamicTokenClient</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ API Key: Custom header</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ JSESSIONID: DynamicTokenManager</span></span>
<span class="line"><span>   ‚îî‚îÄ‚îÄ OAuth2: OAuth flow handling</span></span>
<span class="line"><span>       ‚îÇ</span></span>
<span class="line"><span>       ‚ñº</span></span>
<span class="line"><span>6. HTTP Client Creation</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Base URL configuration</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Authentication headers</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Token management</span></span>
<span class="line"><span>   ‚îî‚îÄ‚îÄ Error handling</span></span>
<span class="line"><span>       ‚îÇ</span></span>
<span class="line"><span>       ‚ñº</span></span>
<span class="line"><span>7. Server Construction</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ FastMCP.from_openapi()</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Route mapping</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Tool registration</span></span>
<span class="line"><span>   ‚îî‚îÄ‚îÄ Authentication integration</span></span>
<span class="line"><span>       ‚îÇ</span></span>
<span class="line"><span>       ‚ñº</span></span>
<span class="line"><span>8. Request Execution</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Authenticated HTTP requests</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Response handling</span></span>
<span class="line"><span>   ‚îú‚îÄ‚îÄ Error processing</span></span>
<span class="line"><span>   ‚îî‚îÄ‚îÄ Result filtering</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h2 id="üõ†Ô∏è-configuration-examples" tabindex="-1">üõ†Ô∏è Configuration Examples <a class="header-anchor" href="#üõ†Ô∏è-configuration-examples" aria-label="Permalink to &quot;üõ†Ô∏è Configuration Examples&quot;">‚Äã</a></h2><h3 id="development-environment" tabindex="-1">Development Environment <a class="header-anchor" href="#development-environment" aria-label="Permalink to &quot;Development Environment&quot;">‚Äã</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Development setup with simple auth</span></span>
<span class="line"><span style="color:#BABED8;">composer </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> MCPComposer</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Dev Composer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_mcp_server</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">dev-server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">openapi</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">open_api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">endpoint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">http://localhost:8001</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">spec_filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/openapi-spec.json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">dev_key_123</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="production-environment" tabindex="-1">Production Environment <a class="header-anchor" href="#production-environment" aria-label="Permalink to &quot;Production Environment&quot;">‚Äã</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Production setup with OAuth</span></span>
<span class="line"><span style="color:#BABED8;">composer </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> MCPComposer</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">    name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Production Composer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic;">    database_config</span><span style="color:#89DDFF;">={</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">cloudant</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">api_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">CLOUDANT_API_KEY</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">service_url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">CLOUDANT_SERVICE_URL</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_mcp_server</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">prod-server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">openapi</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">open_api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">endpoint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://api.production.com/mcp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">spec_filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/openapi-spec.json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">oauth2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">client_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">OAUTH_CLIENT_ID</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">client_secret</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">OAUTH_CLIENT_SECRET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">token_url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">OAUTH_TOKEN_URL</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="multi-environment-setup" tabindex="-1">Multi-Environment Setup <a class="header-anchor" href="#multi-environment-setup" aria-label="Permalink to &quot;Multi-Environment Setup&quot;">‚Äã</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># config.py</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> get_auth_config</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">environment</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;"> str</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#BABED8;"> environment </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">development</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">            &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">            &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">apikey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">dev_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">        }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    elif</span><span style="color:#BABED8;"> environment </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">staging</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">            &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">bearer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">            &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">token</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">STAGING_TOKEN</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)}</span></span>
<span class="line"><span style="color:#89DDFF;">        }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    elif</span><span style="color:#BABED8;"> environment </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">            &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">oauth2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">            &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">                &quot;</span><span style="color:#C3E88D;">client_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">PROD_CLIENT_ID</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">                &quot;</span><span style="color:#C3E88D;">client_secret</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">PROD_CLIENT_SECRET</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">                &quot;</span><span style="color:#C3E88D;">token_url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">PROD_TOKEN_URL</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">            }</span></span>
<span class="line"><span style="color:#89DDFF;">        }</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    raise</span><span style="color:#FFCB6B;"> ValueError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;Unknown environment: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">environment</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># main.py</span></span>
<span class="line"><span style="color:#BABED8;">env </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ENVIRONMENT</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">development</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">auth_config </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> get_auth_config</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">env</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_mcp_server</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">multi-env-server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">openapi</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">open_api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">endpoint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">API_URL</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">spec_filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/openapi-spec.json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    **</span><span style="color:#82AAFF;">auth_config</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="üîí-security-best-practices" tabindex="-1">üîí Security Best Practices <a class="header-anchor" href="#üîí-security-best-practices" aria-label="Permalink to &quot;üîí Security Best Practices&quot;">‚Äã</a></h2><h3 id="_1-environment-variables" tabindex="-1">1. Environment Variables <a class="header-anchor" href="#_1-environment-variables" aria-label="Permalink to &quot;1. Environment Variables&quot;">‚Äã</a></h3><p>Always store sensitive credentials in environment variables:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> os</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_mcp_server</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">secure-server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">openapi</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">open_api</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">endpoint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://api.secure.com/mcp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">spec_filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/openapi-spec.json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth_strategy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">bearer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">token</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">API_TOKEN</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_2-token-rotation" tabindex="-1">2. Token Rotation <a class="header-anchor" href="#_2-token-rotation" aria-label="Permalink to &quot;2. Token Rotation&quot;">‚Äã</a></h3><p>Implement token rotation for enhanced security. See the README for examples.</p><h3 id="_3-credential-encryption" tabindex="-1">3. Credential Encryption <a class="header-anchor" href="#_3-credential-encryption" aria-label="Permalink to &quot;3. Credential Encryption&quot;">‚Äã</a></h3><p>Encrypt sensitive credentials before storage. See the README for examples.</p><h2 id="üîç-troubleshooting" tabindex="-1">üîç Troubleshooting <a class="header-anchor" href="#üîç-troubleshooting" aria-label="Permalink to &quot;üîç Troubleshooting&quot;">‚Äã</a></h2><h3 id="common-authentication-issues" tabindex="-1">Common Authentication Issues <a class="header-anchor" href="#common-authentication-issues" aria-label="Permalink to &quot;Common Authentication Issues&quot;">‚Äã</a></h3><ol><li><p><strong>Invalid Token</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Check token validity</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">member_health</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">except</span><span style="color:#BABED8;"> AuthenticationError </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#BABED8;"> e</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;Authentication failed: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">e</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # Refresh token or update configuration</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li><li><p><strong>Token Expired</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Handle token expiration</span></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#C792EA;"> def</span><span style="color:#82AAFF;"> handle_token_expiration</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">server_id</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;"> str</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">    new_token </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;font-style:italic;"> await</span><span style="color:#82AAFF;"> refresh_token</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">server_id</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    await</span><span style="color:#BABED8;"> composer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">update_mcp_server_config</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        server_id</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        {</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">token</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> new_token</span><span style="color:#89DDFF;">}}</span></span>
<span class="line"><span style="color:#89DDFF;">    )</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li><li><p><strong>OAuth Flow Issues</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Debug OAuth flow</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> logging</span></span>
<span class="line"><span style="color:#BABED8;">logging</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLogger</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mcp_composer.auth_handler.oauth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">setLevel</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">logging</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">DEBUG</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol><h3 id="debugging-authentication" tabindex="-1">Debugging Authentication <a class="header-anchor" href="#debugging-authentication" aria-label="Permalink to &quot;Debugging Authentication&quot;">‚Äã</a></h3><p>Enable debug logging for authentication:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Enable debug logging</span></span>
<span class="line"><span style="color:#BABED8;">logging</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basicConfig</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">level</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">logging</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">DEBUG</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">logging</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLogger</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mcp_composer.auth_handler</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">setLevel</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">logging</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">DEBUG</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">logging</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLogger</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mcp_composer.core.member_servers.builder</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">setLevel</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">logging</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">DEBUG</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="üìö-next-steps" tabindex="-1">üìö Next Steps <a class="header-anchor" href="#üìö-next-steps" aria-label="Permalink to &quot;üìö Next Steps&quot;">‚Äã</a></h2><ul><li><strong><a href="/mcp-composer/examples.html">Examples</a></strong> - Real-world authentication examples</li><li><strong><a href="/mcp-composer/api/">API Reference</a></strong> - Complete API documentation</li><li><strong><a href="/mcp-composer/guide/configuration.html">Configuration Guide</a></strong> - Learn about configuration options</li></ul>`,52))])}const g=c(F,[["render",y]]);export{E as __pageData,g as default};
